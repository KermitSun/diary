<h1 align="center">mysql索引基础</h1>

# 1 常见索引
hash表：
- 采用hash加链表方式存储，用于单点定位；
- 效率基本上可以说是O(1);
- 不支持范围查询；

有序数组：
- 按照字段顺序保存数组；
- 对于排序字段的范围查询有很大优势；
- 采用二分法查找，效率是O(logn);
- 对于插入、删除、更新的效率很低，可以对不再变动的数据使用；

搜索树：
- 对于新增、删除、更改等操作的支持很好；
- 范围查询效率高；
- 查询效率O(logn);

# 2 InnoDB的索引
InnoDB采用b+树索引；

## 2-1 b+树：
- b+树是个n叉树，这个n在mysql里大约是1200左右，该操作主要减少磁盘io；
- 叶子节点位于同一层，也就是说所有含有数据的叶子节点高度一致，深度一致；
- 如果父节点有m个子节点，则父节点里会记录m个值，每个值对应的是每个子节点的最大值的下一个值；
    
## 2-2 回表
InnoDB索引分为两种，主键索引和普通索引；

主键索引里使用id构建b+树，叶子节点保存行数据；

普通的索引里使用索引条件构建b+数，叶子节点保存id和索引条件的数据；

所以，使用普通索引的时候，会造成回表，即先用普通索引查出主键，然后再用id查出数据；

如果页面显示较少，可以把所有要显示的列当做索引，这样可以避免回表，该操作称为覆盖索引；

## 2-3 索引维护
当插入、删除数据时候，或者修改索引字段值时候，会更新索引；

如果数据页满了，就要页分裂，如果太少了，就要页合并，这中操作很影响性能；

并且删除的数据和数据页不是物理删除，而是标记删除，所以会造成数据空洞；

主键id尽量采用自增，这样可以减少主键索引的页分裂和合并；

